<div class="mx-auto max-w-lg">
  <div class="bg-white rounded-lg shadow p-6">
    <div class="text-center mb-6">
      <div class="inline-flex items-center justify-center w-16 h-16 rounded-full bg-green-100 mb-4">
        <svg class="w-8 h-8 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />
        </svg>
      </div>
      <h1 class="font-bold text-2xl mb-2">Save Your Backup Codes</h1>
      <p class="text-gray-600">
        These codes can be used to access your account if you lose your authenticator device.
        Each code can only be used once.
      </p>
    </div>

    <% if flash[:notice] %>
      <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6">
        <p class="text-sm text-blue-700"><%= flash[:notice] %></p>
      </div>
    <% end %>

    <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-6">
      <div class="flex">
        <svg class="w-5 h-5 text-yellow-600 mr-2 flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20">
          <path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd" />
        </svg>
        <div>
          <p class="text-sm font-medium text-yellow-800">Save these codes now</p>
          <p class="text-sm text-yellow-700 mt-1">
            You won't be able to see these codes again. Store them in a secure location like a password manager.
          </p>
        </div>
      </div>
    </div>

    <div class="bg-gray-50 rounded-lg p-6 mb-6">
      <div class="grid grid-cols-2 gap-3">
        <% @backup_codes.each do |code| %>
          <div class="font-mono text-center py-2 px-3 bg-white border rounded text-lg tracking-wider">
            <%= code %>
          </div>
        <% end %>
      </div>
    </div>

    <div class="flex gap-4">
      <button onclick="copyBackupCodes()" class="flex-1 py-2 px-4 bg-gray-200 hover:bg-gray-300 text-gray-700 font-medium rounded-lg transition flex items-center justify-center">
        <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
        </svg>
        Copy Codes
      </button>
      <%= link_to profile_path, class: "flex-1 py-2 px-4 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition text-center" do %>
        Done
      <% end %>
    </div>
  </div>
</div>

<script>
  function copyBackupCodes() {
    const codes = <%= raw @backup_codes.to_json %>;
    const text = "Shelfarr Backup Codes\n" + "=".repeat(20) + "\n\n" + codes.join("\n") + "\n\nKeep these codes safe!";
    navigator.clipboard.writeText(text).then(() => {
      alert("Backup codes copied to clipboard!");
    });
  }
</script>
